<script>
document.addEventListener('DOMContentLoaded', function() {

  const calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
    locale: 'zh-cn',
    initialView: 'listMonth',
    height: 'auto',
    headerToolbar: false,

    events: {
      url: 'https://api.allorigins.win/raw?url=' + encodeURIComponent(
        'https://calendar.google.com/calendar/ical/e75be93f20e20f3b938b2c5af4ec78c4307101f054f7fde80cb32869f0c7c141@group.calendar.google.com/public/basic.ics'
      ),
      format: 'ics'
    },

    eventClick: function(info) {
      info.jsEvent.preventDefault();

      const description = info.event.extendedProps.description;

      if (!description) return;

      const urlMatch = description.match(/https?:\/\/[^\s]+/);

      if (urlMatch) {
        window.location.href = urlMatch[0];
      }
    },

    eventDidMount: function(info) {
      const events = calendar.getEvents()
        .filter(e => e.start >= new Date())
        .sort((a,b) => a.start - b.start);

      events.slice(10).forEach(e => e.remove());

      // make cursor pointer
      info.el.style.cursor = "pointer";
    }

  });

  calendar.render();

});
</script>